"use strict";
'use client';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.SignInPage = SignInPage;
var React = _interopRequireWildcard(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _Avatar = _interopRequireDefault(require("@mui/material/Avatar"));
var _Alert = _interopRequireDefault(require("@mui/material/Alert"));
var _Box = _interopRequireDefault(require("@mui/material/Box"));
var _Checkbox2 = _interopRequireDefault(require("@mui/material/Checkbox"));
var _Container = _interopRequireDefault(require("@mui/material/Container"));
var _Divider = _interopRequireDefault(require("@mui/material/Divider"));
var _FormControlLabel = _interopRequireDefault(require("@mui/material/FormControlLabel"));
var _TextField = _interopRequireDefault(require("@mui/material/TextField"));
var _Typography2 = _interopRequireDefault(require("@mui/material/Typography"));
var _LoadingButton = _interopRequireDefault(require("@mui/lab/LoadingButton"));
var _LockOutlined = _interopRequireDefault(require("@mui/icons-material/LockOutlined"));
var _GitHub = _interopRequireDefault(require("@mui/icons-material/GitHub"));
var _Password = _interopRequireDefault(require("@mui/icons-material/Password"));
var _Facebook = _interopRequireDefault(require("@mui/icons-material/Facebook"));
var _Stack = _interopRequireDefault(require("@mui/material/Stack"));
var _context = require("../shared/context");
var _jsxRuntime = require("react/jsx-runtime");
var _LockOutlinedIcon, _Typography, _Checkbox;
function _getRequireWildcardCache(e) { if ("function" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }
function _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || "object" != typeof e && "function" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if ("default" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }
const IconProviderMap = new Map([['github', /*#__PURE__*/(0, _jsxRuntime.jsx)(_GitHub.default, {}, "github")], ['credentials', /*#__PURE__*/(0, _jsxRuntime.jsx)(_Password.default, {}, "credentials")], ['google',
/*#__PURE__*/
// colored google icon
(0, _jsxRuntime.jsxs)("svg", {
  xmlns: "http://www.w3.org/2000/svg",
  height: "24",
  viewBox: "0 0 24 24",
  width: "24",
  children: [/*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
    d: "M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",
    fill: "#4285F4"
  }), /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
    d: "M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",
    fill: "#34A853"
  }), /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
    d: "M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",
    fill: "#FBBC05"
  }), /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
    d: "M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",
    fill: "#EA4335"
  }), /*#__PURE__*/(0, _jsxRuntime.jsx)("path", {
    d: "M1 1h22v22H1z",
    fill: "none"
  })]
}, "google")], ['facebook', /*#__PURE__*/(0, _jsxRuntime.jsx)(_Facebook.default, {}, "facebook")]]);
/**
 *
 * Demos:
 *
 * - [Sign-in Page](https://mui.com/toolpad/core/react-sign-in-page/)
 *
 * API:
 *
 * - [SignInPage API](https://mui.com/toolpad/core/api/sign-in-page)
 */
function SignInPage(props) {
  var _router$searchParams$, _branding$logo;
  const {
    providers,
    signIn,
    slots,
    slotProps
  } = props;
  const branding = React.useContext(_context.BrandingContext);
  const docs = React.useContext(_context.DocsContext);
  const router = React.useContext(_context.RouterContext);
  const credentialsProvider = providers == null ? void 0 : providers.find(provider => provider.id === 'credentials');
  const [{
    loading,
    providerId,
    error
  }, setFormStatus] = React.useState({
    providerId: '',
    loading: false,
    error: ''
  });
  const callbackUrl = (_router$searchParams$ = router == null ? void 0 : router.searchParams.get('callbackUrl')) != null ? _router$searchParams$ : '/';
  const singleProvider = React.useMemo(() => (providers == null ? void 0 : providers.length) === 1, [providers]);
  return /*#__PURE__*/(0, _jsxRuntime.jsx)(_Container.default, {
    component: "main",
    maxWidth: "xs",
    children: /*#__PURE__*/(0, _jsxRuntime.jsxs)(_Box.default, {
      sx: {
        marginTop: 8,
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center'
      },
      children: [(_branding$logo = branding == null ? void 0 : branding.logo) != null ? _branding$logo : /*#__PURE__*/(0, _jsxRuntime.jsx)(_Avatar.default, {
        sx: {
          my: 1,
          mb: 2,
          bgcolor: 'primary.main'
        },
        children: _LockOutlinedIcon || (_LockOutlinedIcon = /*#__PURE__*/(0, _jsxRuntime.jsx)(_LockOutlined.default, {}))
      }), /*#__PURE__*/(0, _jsxRuntime.jsxs)(_Typography2.default, {
        variant: "h5",
        color: "textPrimary",
        gutterBottom: true,
        children: ["Sign in ", branding != null && branding.title ? `to ${branding.title}` : null]
      }), _Typography || (_Typography = /*#__PURE__*/(0, _jsxRuntime.jsx)(_Typography2.default, {
        variant: "body2",
        color: "textSecondary",
        gutterBottom: true,
        children: "Welcome user, please sign in to continue"
      })), /*#__PURE__*/(0, _jsxRuntime.jsxs)(_Box.default, {
        sx: {
          mt: 2
        },
        children: [/*#__PURE__*/(0, _jsxRuntime.jsxs)(_Stack.default, {
          spacing: 1,
          children: [error && providerId !== 'credentials' ? /*#__PURE__*/(0, _jsxRuntime.jsx)(_Alert.default, {
            severity: "error",
            children: error
          }) : null, Object.values(providers != null ? providers : {}).map(provider => {
            if (provider.id === 'credentials') {
              return null;
            }
            return /*#__PURE__*/(0, _jsxRuntime.jsx)("form", {
              onSubmit: async event => {
                event.preventDefault();
                setFormStatus({
                  error: '',
                  providerId: provider.id,
                  loading: true
                });
                const oauthResponse = await (signIn == null ? void 0 : signIn(provider, undefined, callbackUrl));
                setFormStatus(prev => ({
                  ...prev,
                  loading: oauthResponse != null && oauthResponse.error || docs ? false : prev.loading,
                  error: oauthResponse == null ? void 0 : oauthResponse.error
                }));
              },
              children: /*#__PURE__*/(0, _jsxRuntime.jsx)(_LoadingButton.default, {
                variant: "contained",
                type: "submit",
                fullWidth: true,
                size: "large",
                disableElevation: true,
                name: 'provider',
                color: singleProvider ? 'primary' : 'inherit',
                loading: loading && providerId === provider.id,
                value: provider.id,
                startIcon: IconProviderMap.get(provider.id),
                sx: {
                  textTransform: 'capitalize',
                  filter: 'opacity(0.9)',
                  transition: 'filter 0.2s ease-in',
                  '&:hover': {
                    filter: 'opacity(1)'
                  }
                },
                children: /*#__PURE__*/(0, _jsxRuntime.jsxs)("span", {
                  children: ["Sign in with ", provider.name]
                })
              }, provider.id)
            }, provider.id);
          })]
        }), credentialsProvider ? /*#__PURE__*/(0, _jsxRuntime.jsxs)(React.Fragment, {
          children: [singleProvider ? null : /*#__PURE__*/(0, _jsxRuntime.jsx)(_Divider.default, {
            sx: {
              mt: 2,
              mx: 0,
              mb: 1
            },
            children: "or"
          }), error && providerId === 'credentials' ? /*#__PURE__*/(0, _jsxRuntime.jsx)(_Alert.default, {
            sx: {
              my: 2
            },
            severity: "error",
            children: error
          }) : null, /*#__PURE__*/(0, _jsxRuntime.jsxs)(_Box.default, {
            component: "form",
            onSubmit: async event => {
              setFormStatus({
                error: '',
                providerId: credentialsProvider.id,
                loading: true
              });
              event.preventDefault();
              const formData = new FormData(event.currentTarget);
              const credentialsResponse = await (signIn == null ? void 0 : signIn(credentialsProvider, formData, callbackUrl));
              setFormStatus(prev => ({
                ...prev,
                loading: false,
                error: credentialsResponse == null ? void 0 : credentialsResponse.error
              }));
            },
            children: [slots != null && slots.emailField ? /*#__PURE__*/(0, _jsxRuntime.jsx)(slots.emailField, {
              ...(slotProps == null ? void 0 : slotProps.emailField)
            }) : /*#__PURE__*/(0, _jsxRuntime.jsx)(_TextField.default, {
              margin: "dense",
              required: true,
              slotProps: {
                htmlInput: {
                  sx: {
                    paddingTop: '12px',
                    paddingBottom: '12px'
                  }
                },
                inputLabel: {
                  sx: {
                    lineHeight: '1rem'
                  }
                }
              },
              fullWidth: true,
              id: "email",
              label: "Email Address",
              name: "email",
              type: "email",
              autoComplete: "email",
              autoFocus: docs ? false : singleProvider,
              ...(slotProps == null ? void 0 : slotProps.emailField)
            }), slots != null && slots.passwordField ? /*#__PURE__*/(0, _jsxRuntime.jsx)(slots.passwordField, {
              ...(slotProps == null ? void 0 : slotProps.passwordField)
            }) : /*#__PURE__*/(0, _jsxRuntime.jsx)(_TextField.default, {
              margin: "dense",
              required: true,
              fullWidth: true,
              slotProps: {
                htmlInput: {
                  sx: {
                    paddingTop: '12px',
                    paddingBottom: '12px'
                  }
                },
                inputLabel: {
                  sx: {
                    lineHeight: '1rem'
                  }
                }
              },
              name: "password",
              label: "Password",
              type: "password",
              id: "password",
              autoComplete: "current-password",
              ...(slotProps == null ? void 0 : slotProps.passwordField)
            }), /*#__PURE__*/(0, _jsxRuntime.jsx)(_FormControlLabel.default, {
              control: _Checkbox || (_Checkbox = /*#__PURE__*/(0, _jsxRuntime.jsx)(_Checkbox2.default, {
                value: "remember",
                color: "primary"
              })),
              label: "Remember me",
              slotProps: {
                typography: {
                  color: 'textSecondary'
                }
              }
            }), slots != null && slots.submitButton ? /*#__PURE__*/(0, _jsxRuntime.jsx)(slots.submitButton, {
              ...(slotProps == null ? void 0 : slotProps.submitButton)
            }) : /*#__PURE__*/(0, _jsxRuntime.jsx)(_LoadingButton.default, {
              type: "submit",
              fullWidth: true,
              size: "large",
              variant: "contained",
              disableElevation: true,
              color: singleProvider ? 'primary' : 'inherit',
              loading: loading && providerId === credentialsProvider.id,
              sx: {
                mt: 3,
                mb: 2,
                textTransform: 'capitalize',
                filter: 'opacity(0.9)',
                transition: 'filter 0.2s ease-in',
                '&:hover': {
                  filter: 'opacity(1)'
                }
              },
              ...(slotProps == null ? void 0 : slotProps.submitButton),
              children: "Sign in"
            }), slots != null && slots.forgotPasswordLink || slots != null && slots.signUpLink ? /*#__PURE__*/(0, _jsxRuntime.jsxs)(_Box.default, {
              sx: {
                display: 'flex',
                justifyContent: 'space-between',
                mt: 2
              },
              children: [slots != null && slots.forgotPasswordLink ? /*#__PURE__*/(0, _jsxRuntime.jsx)(slots.forgotPasswordLink, {
                ...(slotProps == null ? void 0 : slotProps.forgotPasswordLink)
              }) : null, slots != null && slots.signUpLink ? /*#__PURE__*/(0, _jsxRuntime.jsx)(slots.signUpLink, {
                ...(slotProps == null ? void 0 : slotProps.signUpLink)
              }) : null]
            }) : null]
          })]
        }) : null]
      })]
    })
  });
}
process.env.NODE_ENV !== "production" ? SignInPage.propTypes /* remove-proptypes */ = {
  // ┌────────────────────────────── Warning ──────────────────────────────┐
  // │ These PropTypes are generated from the TypeScript type definitions. │
  // │ To update them, edit the TypeScript types and run `pnpm proptypes`. │
  // └─────────────────────────────────────────────────────────────────────┘
  /**
   * The list of authentication providers to display.
   * @default []
   */
  providers: _propTypes.default.arrayOf(_propTypes.default.shape({
    id: _propTypes.default.string.isRequired,
    name: _propTypes.default.string.isRequired
  })),
  /**
   * Callback fired when a user signs in.
   * @param {AuthProvider} provider The authentication provider.
   * @param {FormData} formData The form data if the provider id is 'credentials'.\
   * @param {string} callbackUrl The URL to redirect to after signing in.
   * @returns {void|Promise<AuthResponse>}
   * @default undefined
   */
  signIn: _propTypes.default.func,
  /**
   * The props used for each slot inside.
   * @default {}
   * @example { emailField: { autoFocus: false } }
   * @example { passwordField: { variant: 'outlined' } }
   * @example { emailField: { autoFocus: false }, passwordField: { variant: 'outlined' } }
   */
  slotProps: _propTypes.default.shape({
    emailField: _propTypes.default.object,
    forgotPasswordLink: _propTypes.default.object,
    passwordField: _propTypes.default.object,
    signUpLink: _propTypes.default.object,
    submitButton: _propTypes.default.object
  }),
  /**
   * The components used for each slot inside.
   * @default {}
   * @example { forgotPasswordLink: <Link href="/forgot-password">Forgot password?</Link> }
   * @example { signUpLink: <Link href="/sign-up">Sign up</Link> }
   */
  slots: _propTypes.default.shape({
    emailField: _propTypes.default.elementType,
    forgotPasswordLink: _propTypes.default.elementType,
    passwordField: _propTypes.default.elementType,
    signUpLink: _propTypes.default.elementType,
    submitButton: _propTypes.default.elementType
  })
} : void 0;